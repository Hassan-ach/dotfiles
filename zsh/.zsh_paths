# ==============================
# Paths and Environment Variables
# ==============================

# Core System Paths
export PATH="$HOME/.local/bin:$PATH"
export PATH="$HOME/.config/composer/vendor/bin:$PATH"
export PATH="$HOME/.cargo/bin:$PATH"
export PATH="$HOME/go/bin:$PATH"
export PATH="$HOME/.npm-global/bin:$PATH"

# Development Tools
export VCPKG_ROOT="$HOME/git-clone-projects/vcpkg"
export PATH="$VCPKG_ROOT:$PATH"

# Editor Configuration
export EDITOR='nvim'
export VISUAL='nvim'

# Terminal Configuration
# Uncomment if needed for specific terminal features
# export TERM="xterm-kitty"
# export COLORTERM=truecolor

# History Settings
export HISTFILE="$HOME/.zsh_history"
export HISTSIZE=5000
export SAVEHIST=5000
export HISTORY_IGNORE="(ls|cd|pwd|exit|sudo reboot|history|cd -|cd ..)"

# Bat Configuration
export BAT_PAGER="less -RF"
export BAT_THEME="rose-pine"  # Uncomment to set theme

# Man Page Styling with Bat
export MANPAGER="nvim +Man!"

# PHP Configuration
export PHP_INI_SCAN_DIR="/home/bagi/.config/herd-lite/bin:$PHP_INI_SCAN_DIR"

# Window Manager Environment Variables
# Sway/Wayland Configuration
# export XDG_CURRENT_DESKTOP=sway
# if [[ "$XDG_CURRENT_DESKTOP" == "sway"]]; then
#   export XDG_SESSION_DESKTOP=sway
#   export XDG_SESSION_TYPE=wayland
#   export WAYLAND_DISPLAY=wayland-1
# fi

# hyprland session initialitation
if [[ "$XDG_CURRENT_DESKTOP" == Hyprland ]]; then
    # exec dbus-run-session -- Hyprland
fi



# FZF Theme Configuration (Uncomment to enable)
# export FZF_DEFAULT_OPTS=" \
#   --height 40% \
#   --layout=reverse \
#   --border=rounded \
#   --info=inline \
#   --margin=1,1 \
#   --padding=0,1 \
#   --color=fg:#e0def4,bg:#191724,hl:#eb6f92 \
#   --color=fg+:#e0def4,bg+:#26233a,hl+:#ebbcba \
#   --color=info:#6e6a86,prompt:#f6c177,pointer:#9ccfd8 \
#   --color=marker:#eb6f92,spinner:#c4a7e7,header:#31748f \
#   --color=border:#403d52 \
#   --color=gutter:#191724 \
#   --color=query:#e0def4 \
#   --color=disabled:#6e6a86 \
#   --color=preview-fg:#e0def4 \
#   --color=preview-bg:#1f1d2e \
# "
export FZF_DEFAULT_OPTS=" \
  --height 40% \
  --layout=reverse \
  --border=rounded \
  --info=inline \
  --margin=1,1 \
  --padding=0,1 \
  --color=fg:#e0def4 \
  --color=bg:#191724 \
  --color=hl:#eb6f92 \
  --color=fg+:#e0def4 \
  --color=bg+:#26233a \
  --color=hl+:#ebbcba \
  --color=info:#908caa \
  --color=prompt:#f6c177 \
  --color=pointer:#9ccfd8 \
  --color=marker:#eb6f92 \
  --color=spinner:#c4a7e7 \
  --color=header:#31748f \
  --color=border:#403d52 \
  --color=gutter:#191724 \
  --color=query:#e0def4 \
  --color=disabled:#6e6a86 \
  --color=preview-fg:#e0def4 \
  --color=preview-bg:#1f1d2e \
"
# export FZF_DEFAULT_OPTS="
# 	--color=fg:#908caa,bg:#191724,hl:#ebbcba \
# 	--color=fg+:#e0def4,bg+:#26233a,hl+:#ebbcba \
# 	--color=border:#403d52,header:#31748f,gutter:#191724 \
# 	--color=spinner:#f6c177,info:#9ccfd8 \
# 	--color=pointer:#c4a7e7,marker:#eb6f92,prompt:#908caa"

# Dynamic Wayland/X11 Detection for Environment
if [[ "$XDG_SESSION_TYPE" == "wayland" ]]; then
    # Wayland-specific configurations
    export MOZ_ENABLE_WAYLAND=1
    export QT_QPA_PLATFORM=wayland
    export GDK_BACKEND=wayland
elif [[ "$DISPLAY" ]]; then
    # X11-specific configurations
    export QT_QPA_PLATFORM=xcb
    export GDK_BACKEND=x11
fi

# GHCup - Consider lazy loading if it's a bottleneck (check zprof)
# [ -f "/home/bagi/.ghcup/env" ] && source "/home/bagi/.ghcup/env" # This is now in .zshrc, consider moving here or lazy loading

# SDKMAN (Lazy Loaded)
export SDKMAN_DIR="$HOME/.sdkman"
# Comment out the direct source, as it's now lazy-loaded
# [[ -s "$HOME/.sdkman/bin/sdkman-init.sh" ]] && source "$HOME/.sdkman/bin/sdkman-init.sh"

# Define a function that sources SDKMAN only when `sdk` is first called
sdk() {
  unset -f sdk # Unset this function so the real `sdk` command is found next time
  [[ -s "$HOME/.sdkman/bin/sdkman-init.sh" ]] && source "$HOME/.sdkman/bin/sdkman-init.sh"
  sdk "$@" # Call the real sdk command with the original arguments
}

# Auto-set JAVA_HOME based on Arch's default
if [[ -L /usr/lib/jvm/default ]]; then
    DEFAULT_JAVA=$(readlink -f /usr/lib/jvm/default)
    export JAVA_HOME=$DEFAULT_JAVA
    export PATH="$JAVA_HOME/bin:$PATH"
fi

# Tomcat env
export CATALINA_HOME=/opt/tomcat
export PATH=$PATH:$CATALINA_HOME/bin
